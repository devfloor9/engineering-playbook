<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 900 735" style="font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;">
  <!-- Background -->
  <rect width="900" height="735" fill="#ffffff"/>

  <!-- Title -->
  <text x="50" y="30" font-size="16" font-weight="600" fill="#111827">
    kube-proxy (iptables) vs Cilium (eBPF) — Service Scaling Comparison
  </text>
  <text x="50" y="50" font-size="13" fill="#6b7280">
    4 → 104 → 1,000 Services — Impact on latency, throughput, and rule complexity
  </text>

  <!-- Legend -->
  <g transform="translate(480, 20)">
    <rect x="0" y="0" width="16" height="12" fill="#cbd5e1" rx="2"/>
    <text x="22" y="11" font-size="11" fill="#374151">4 Services</text>
    <rect x="105" y="0" width="16" height="12" fill="#64748b" rx="2"/>
    <text x="127" y="11" font-size="11" fill="#374151">104 Services</text>
    <rect x="220" y="0" width="16" height="12" fill="#1e293b" rx="2"/>
    <text x="242" y="11" font-size="11" fill="#374151">1,000 Services</text>
  </g>

  <!-- Section: kube-proxy (iptables) -->
  <text x="50" y="85" font-size="15" font-weight="600" fill="#374151">kube-proxy (iptables)</text>

  <!-- HTTP p99 -->
  <g transform="translate(0, 100)">
    <text x="50" y="18" font-size="13" font-weight="500" fill="#1f2937">HTTP p99 @QPS=1000</text>
    <rect x="240" y="3" width="117" height="18" fill="#cbd5e1" rx="2"/>
    <text x="362" y="17" font-size="11" fill="#1f2937">5.86ms</text>
    <rect x="240" y="25" width="120" height="18" fill="#64748b" rx="2"/>
    <text x="365" y="39" font-size="11" fill="#ffffff">5.99ms</text>
    <rect x="240" y="47" width="59" height="18" fill="#1e293b" rx="2"/>
    <text x="304" y="61" font-size="11" fill="#1f2937">2.96ms</text>
    <text x="360" y="55" font-size="11" fill="#059669" font-weight="500">-49%</text>
  </g>

  <!-- Max QPS -->
  <g transform="translate(0, 170)">
    <text x="50" y="18" font-size="13" font-weight="500" fill="#1f2937">Max QPS (keepalive)</text>
    <rect x="240" y="3" width="210" height="18" fill="#cbd5e1" rx="2"/>
    <text x="455" y="17" font-size="11" fill="#1f2937">4,197</text>
    <rect x="240" y="25" width="212" height="18" fill="#64748b" rx="2"/>
    <text x="457" y="39" font-size="11" fill="#ffffff">4,231</text>
    <rect x="240" y="47" width="209" height="18" fill="#1e293b" rx="2"/>
    <text x="454" y="61" font-size="11" fill="#ffffff">4,178</text>
    <text x="500" y="55" font-size="11" fill="#059669" font-weight="500">~same</text>
  </g>

  <!-- TCP Throughput -->
  <g transform="translate(0, 240)">
    <text x="50" y="18" font-size="13" font-weight="500" fill="#1f2937">TCP Throughput</text>
    <rect x="240" y="3" width="248" height="18" fill="#cbd5e1" rx="2"/>
    <text x="493" y="17" font-size="11" fill="#1f2937">12.4 Gbps</text>
    <rect x="240" y="25" width="248" height="18" fill="#64748b" rx="2"/>
    <text x="493" y="39" font-size="11" fill="#ffffff">12.4 Gbps</text>
    <rect x="240" y="47" width="248" height="18" fill="#1e293b" rx="2"/>
    <text x="493" y="61" font-size="11" fill="#ffffff">12.4 Gbps</text>
    <text x="550" y="55" font-size="11" fill="#059669" font-weight="500">identical</text>
  </g>

  <!-- iptables Rules — KEY METRIC -->
  <g transform="translate(0, 315)">
    <text x="50" y="18" font-size="13" font-weight="600" fill="#dc2626">iptables NAT Rules</text>
    <rect x="240" y="3" width="30" height="18" fill="#cbd5e1" rx="2"/>
    <text x="275" y="17" font-size="11" fill="#1f2937">99</text>
    <rect x="240" y="25" width="50" height="18" fill="#64748b" rx="2"/>
    <text x="295" y="39" font-size="11" fill="#1f2937">699</text>
    <text x="335" y="39" font-size="11" fill="#dc2626" font-weight="500">7×</text>
    <rect x="240" y="47" width="500" height="18" fill="#1e293b" rx="2"/>
    <text x="745" y="61" font-size="11" fill="#1f2937">10,059</text>
    <text x="800" y="61" font-size="12" fill="#dc2626" font-weight="700">101×!</text>
  </g>

  <!-- kube-proxy Sync Time -->
  <g transform="translate(0, 385)">
    <text x="50" y="18" font-size="13" font-weight="500" fill="#1f2937">kube-proxy sync time</text>
    <rect x="240" y="3" width="130" height="18" fill="#cbd5e1" rx="2"/>
    <text x="375" y="17" font-size="11" fill="#1f2937">~130ms</text>
    <rect x="240" y="25" width="160" height="18" fill="#64748b" rx="2"/>
    <text x="405" y="39" font-size="11" fill="#ffffff">~160ms</text>
    <rect x="240" y="47" width="170" height="18" fill="#1e293b" rx="2"/>
    <text x="415" y="61" font-size="11" fill="#ffffff">~170ms</text>
    <text x="460" y="55" font-size="11" fill="#dc2626" font-weight="500">+31%</text>
  </g>

  <!-- Section: Cilium (eBPF) -->
  <text x="50" y="460" font-size="15" font-weight="600" fill="#065f46">Cilium (eBPF)</text>

  <!-- HTTP p99 -->
  <g transform="translate(0, 475)">
    <text x="50" y="18" font-size="13" font-weight="500" fill="#1f2937">HTTP p99 @QPS=1000</text>
    <rect x="240" y="3" width="158" height="18" fill="#93c5fd" rx="2"/>
    <text x="403" y="17" font-size="11" fill="#1f2937">3.94ms</text>
    <rect x="240" y="25" width="146" height="18" fill="#3b82f6" rx="2"/>
    <text x="391" y="39" font-size="11" fill="#ffffff">3.64ms</text>
    <text x="440" y="35" font-size="11" fill="#059669" font-weight="500">-8% (noise)</text>
  </g>

  <!-- eBPF Map Lookup -->
  <g transform="translate(0, 535)">
    <text x="50" y="18" font-size="13" font-weight="500" fill="#1f2937">eBPF map lookup</text>
    <rect x="240" y="3" width="180" height="22" fill="#10b981" rx="2"/>
    <text x="425" y="19" font-size="12" fill="#ffffff" font-weight="600">O(1) constant time</text>
    <text x="470" y="19" font-size="12" fill="#065f46" font-weight="500">(no growth)</text>
  </g>

  <!-- Insight Box -->
  <rect x="50" y="590" width="800" height="130" fill="#fef3c7" stroke="#f59e0b" stroke-width="2" rx="6"/>
  <text x="65" y="613" font-size="13" font-weight="600" fill="#92400e">Key Insight (Measured):</text>
  <text x="65" y="633" font-size="12" fill="#92400e">
    At 1,000 services, iptables rules grow 101× (99 → 10,059) but sync time only reaches ~170ms.
  </text>
  <text x="65" y="651" font-size="12" fill="#92400e">
    Per-connection overhead: +26µs (+16%) connection setup via Connection:close test (164→190µs).
  </text>
  <text x="65" y="669" font-size="12" fill="#92400e">
    Keepalive HTTP latency/throughput remain stable — conntrack reuse bypasses rule traversal.
  </text>
  <text x="65" y="687" font-size="12" fill="#92400e">
    Real degradation threshold: 5,000+ services (sync >500ms, chain traversal adds 100s of µs).
  </text>
  <text x="65" y="705" font-size="12" fill="#92400e">
    Cilium eBPF maintains O(1) hash map lookup regardless of service count.
  </text>
</svg>
